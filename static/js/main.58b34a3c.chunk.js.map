{"version":3,"sources":["lib/Defs.tsx","components/CubeSim.tsx","lib/Math.tsx","lib/CubeLib.tsx","components/CmllTrainerView.tsx","components/FbdrTrainerView.tsx","components/AppView.tsx","lib/Algs.tsx","components/Config.tsx","Version.tsx","lib/Pruner.tsx","lib/Solver.tsx","lib/CachedSolver.tsx","Reducer.tsx","app/App.tsx","serviceWorker.js","theme.js","index.js"],"names":["Face","Typ","U","D","F","B","L","R","C","E","T","corners_coord","edges_coord","u","cpc","coc","epc","eoc","tpc","name","f","r","l","d","b","m","e","u_face","f_face","color_map","defaultKeyMapping","TAU","Math","PI","axesInfo","THREE","cubeSim","width","height","colorScheme","mode","stickers_tmpl","stickerwrap_tmpl","scene","camera","renderer","antialias","geo","geo_border","position","copy","lookAt","cubeG","add","updateWidthHeight","setSize","setClearColor","aspect","updateProjectionMatrix","domElement","updateCube","cube","remove","faces","i","cubie","rot","makeRotationFromEuler","rot1","setRotationFromMatrix","multiply","z","x","idx","curr_tmpl","sticker","clone","stickerwrap","stickerhint","scale","set","drawCube","renderScene","render","cleanup","dispose","updateColorScheme","colorScheme_","materials","Array","fill","map","_","color","side","materials_border","mat","mesh","setRotationFromEuler","setup","CubeSim","props","mount","React","useRef","useEffect","dom","current","appendChild","removeChild","ref","style","rand_int","floor","random","rand_incl","rand_choice","arr","length","getParity","perm","visited","follow","cnt","res","arrayEqual","arr1","arr2","CubieCube","id","cp","co","ep","eo","tp","apply_partial","o","p","oc","pc","mod","o_new","p_new","console","assert","src","dst","apply_one","move","toc","apply","isArray","from_move","Move","from_moves","moves","get_change","acc_p","acc_o","push","from_cube","make_rot_set","all_moves","us","fs","rs","ls","ds","bs","ms","es","rw","rws","lw","lws","uw","uws","xs","y","ys","flat","moves_dict","Object","create","forEach","generate_base_moves","all","parse","str","tokens","replace","split","filter","Boolean","token","inv","slice","reverse","add_auf","auf_moves","auf_move","concat","to_string","join","FaceletCube","mult_move","face","face_new","work","typ","mod_for_typ","p1","p2","p_curr","o_curr","color_of_c","o1","o2","color_of_e","color_of_t","d_face","l_face","r_face","b_face","from_cubie","mask","facelet","X","Error","from_cubie_partial_masked","from_cubie_partial","to_unfolded_cube_str","faceletCube","face_count","str_face_map","color_cube","face_char","hasOwnProperty","count","lse_mask","fs_back_mask","CubeUtil","u_premove","m_premove","m2_premove","get_random_with_mask","cp_rand","ep_rand","par","random_ori","ori_mask","sum","ori","random_perm","perm_mask","undecided","j","tmp","rand_shuffle","is_cmll_solved","premove","cube1","solved","is_mask_solved","get_random_lse","get_random_fs","ori_to_color_scheme","colorMap","Map","valid_scheme_mapper","s","ch","get","sel","is_cube_solved","Mask","fbdr_mask","useStyles","makeStyles","theme","container","paddingTop","spacing","paddingBottom","paper","padding","display","overflow","flexDirection","fixedHeight","canvasPaper","title","flexGrow","SelectorGroupPanel","selector","handleChange","FormGroup","row","names","checked","FormControlLabel","control","Checkbox","onChange","label","key","makeBox","flags","CmllTrainerView","state","dispatch","config","classes","clsx","handleSelectorChange","useCallback","selectorSel","new_flags","indexOf","new_config","type","content","Container","maxWidth","className","Grid","justify","alignItems","item","md","lg","Paper","Box","margin","cmllSelector","cmllAufSelector","triggerSelector","orientationSelector","button","infoColumn","textColumn","FbdrTrainerView","desc","case","alg","alt_algs","spaceButtonText","algText","fbdrSelector","radioValue","elevation","sm","fontWeight","border","borderTop","borderLeft","borderRight","borderColor","lineHeight","fontSize","Typography","whiteSpace","Button","size","variant","onClick","Divider","FormControl","component","FormLabel","RadioGroup","aria-label","value","evt","n","target","Radio","labelPlacement","TabPanel","children","index","other","role","hidden","aria-labelledby","page","backgroundColor","AppView","newValue","setValue","useState","AppBar","Tabs","Tab","empty_alg","kind","cmll_algs","trigger_algs","u_auf_algs","ori_algs","alg_generator","algSet","lookup_algset","lookup","Set","get_active_names","algs","prefix","has","initialConfig","arr_ori_flag","configManager","cache","getConfig","window","localStorage","getItem","vers","undefined","setItem","JSON","stringify","item1","keys","setConfig","partial","newConfig","assign","fbdrPrunerConfig","pow","encode","c1","c2","enc_c","e1","e2","e3","e4","solved_states","max_depth","moveset","Solver","accum","min_depth","SState","MAX_STATE_COUNT","is_solved","pruners","state_count","prune_count","solve_depth","min_depth_","max_depth_","accum_","search","depth","solution","STOP","CONTINUE","solutions","capacity","flag","sol","try_push","query","last_move_face","new_cube","equal","st","pop","expand","solve","depth_l","depth_r","log","getPruner","FbdrSolver","prunerConfig","pruner","dist","initialized","init","Uint8Array","frontier","total_expanded","new_frontier","newState","cube2","Pruner","CachedSolver","getInitialState","history","reducer","action","code","stateM","StateM","reduceKey","this","FbdrStateM","SolvingStateM","SolvedStateM","CmllStateM","generator","trig_generator","u_auf_generator","ori_generator","trigger_alg","u_auf_alg","alg_str","solver","scramble","algdesc","updateScramble","movestr","addEventListener","keyCode","document","body","preventDefault","App","useReducer","downHandler","toUpperCase","removeEventListener","location","hostname","match","createMuiTheme","palette","primary","main","secondary","error","red","A400","background","default","ReactDOM","ThemeProvider","CssBaseline","getElementById","navigator","serviceWorker","ready","then","registration","unregister"],"mappings":"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","file":"static/js/main.58b34a3c.chunk.js","sourcesContent":["export enum Face {\n    U = 0, D, F, B, L, R, X\n}\nconst U = Face.U;\nconst D = Face.D;\nconst F = Face.F;\nconst B = Face.B;\nconst L = Face.L;\nconst R = Face.R;\nexport {U, D, F, B, L, R};\n\nexport enum Typ {\n    C = 0, E, T\n}\nconst C = Typ.C;\nconst E = Typ.E;\nconst T = Typ.T;\nexport {C, E, T}\n\nexport type CubieT = {\n    co: Array<number>,\n    cp: Array<number>,\n    eo: Array<number>,\n    ep: Array<number>,\n    tp: Array<number>\n}\n\nexport type FaceletCube = Array<string>\n\nexport type CornerCoord = [Face, Face, Face]\nlet corners_coord : Array<CornerCoord> = [\n    [U,F,L], [U,L,B], [U,B,R], [U,R,F],\n    [D,L,F], [D,B,L], [D,R,B], [D,F,R]\n]\n\nexport type EdgeCoord = [Face, Face]\nlet edges_coord : Array<EdgeCoord> = [\n    [U,F], [U,L], [U,B], [U,R],\n    [D,F], [D,L], [D,B], [D,R],\n    [F,L], [B,L], [B,R], [F,R],\n]\nexport {corners_coord, edges_coord}\n\nexport type PermChg = [number, number]\nexport type OriChg = number\n\nexport type MoveT = {\n    cpc: Array<PermChg>,\n    coc: Array<OriChg>,\n    epc: Array<PermChg>,\n    eoc: Array<OriChg>,\n    tpc: Array<PermChg>,\n    name: string\n}\n\nlet u : MoveT = {\n    cpc: [[0, 1], [1, 2], [2, 3], [3, 0]],\n    coc: [0, 0, 0, 0],\n    epc: [[0, 1], [1, 2], [2, 3], [3, 0]],\n    eoc: [0, 0, 0, 0],\n    tpc: [],\n    name: \"U\"\n}\n\nlet f : MoveT = {\n    cpc: [[0, 3], [3, 7], [7, 4], [4, 0]],\n    coc: [1, 2, 1, 2],\n    epc: [[0, 11], [11, 4], [4, 8], [8, 0]],\n    eoc: [1, 1, 1, 1],\n    tpc: [],\n    name: \"F\",\n}\n\nlet r : MoveT = {\n    cpc: [[3, 2], [2, 6], [6, 7], [7, 3]],\n    coc: [1, 2, 1, 2],\n    epc: [[3, 10], [10, 7], [7, 11], [11, 3]],\n    eoc: [0, 0, 0, 0],\n    tpc: [],\n    name: \"R\",\n}\n\nlet l : MoveT = {\n    cpc: [[0, 4], [4, 5], [5, 1], [1, 0]],\n    coc: [2, 1, 2, 1],\n    epc: [[1, 8], [8, 5], [5, 9], [9, 1]],\n    eoc: [0, 0, 0, 0],\n    tpc: [],\n    name: \"L\",\n}\n\nlet d : MoveT = {\n    cpc: [[4, 7], [7, 6], [6, 5], [5, 4]],\n    coc: [0, 0, 0, 0],\n    epc: [[4, 7], [7, 6], [6, 5], [5, 4]],\n    eoc: [0, 0, 0, 0],\n    tpc: [],\n    name: \"D\",\n}\n\nlet b : MoveT = {\n    cpc: [[1, 5], [5, 6], [6, 2], [2, 1]],\n    coc: [2, 1, 2, 1],\n    epc: [[2, 9], [9, 6], [6, 10], [10, 2]],\n    eoc: [1, 1, 1, 1],\n    tpc: [],\n    name: \"B\",\n}\n\nlet m : MoveT = {\n    cpc: [],\n    coc: [],\n    epc: [[0, 4], [4, 6], [6, 2], [2, 0]],\n    eoc: [1, 1, 1, 1],\n    tpc: [[0, 2], [2, 1], [1, 3], [3, 0]],\n    name: \"M\",\n}\n\nlet e : MoveT = {\n    cpc: [],\n    coc: [],\n    epc: [[8, 9], [9, 10], [10, 11], [11, 8]],\n    eoc: [1, 1, 1, 1],\n    tpc: [[2, 4], [4, 3], [3, 5], [5, 2]],\n    name: \"E\",\n}\n\nexport {u, d, f, b, l, r, m, e}\n\nexport type FaceletT = Array<[number, number, Typ]>\n\nlet u_face : FaceletT = [\n    [1, 0, C], [2, 0, E], [2, 0, C],\n    [1, 0, E], [0, 0, T], [3, 0, E],\n    [0, 0, C], [0, 0, E], [3, 0, C]\n  ]\n\nlet f_face : FaceletT = [\n    [0, 1, C], [0, 1, E], [3, 2, C],\n    [8, 0, E], [2, 0, T], [11,0, E],\n    [4, 2, C], [4, 1, E], [7, 1, C]\n]\n\nexport {u_face, f_face}\n\nexport type FaceletCubeT = Array<Array<Face>>\n\n// A Cube can be in two representations: cubieCube or faceletCube\n\nlet color_map =`\\\n   UUU\n   UUU\n   UUU\nLLLFFFRRRBBB\nLLLFFFRRRBBB\nLLLFFFRRRBBB\n   DDD\n   DDD\n   DDD`\n\nexport {color_map}\n\nconst defaultKeyMapping : { [key: string]: string } = {\n    \"I\": \"R\",\n    \"K\": \"R'\",\n    \"W\": \"B\",\n    \"O\": \"B'\",\n    \"S\": \"D\",\n    \"L\": \"D'\",\n    \"D\": \"L\",\n    \"E\": \"L'\",\n    \"J\": \"U\",\n    \"F\": \"U'\",\n    \"H\": \"F\",\n    \"G\": \"F'\",\n    \";\": \"y\",\n    \"A\": \"y'\",\n    \"U\": \"r\",\n    \"R\": \"l'\",\n    \"M\": \"r'\",\n    \"V\": \"l\",\n    \"T\": \"x\",\n    \"Y\": \"x\",\n    \"N\": \"x'\",\n    \"B\": \"x'\",\n    \".\": \"M'\",\n    \"X\": \"M'\",\n    \"5\": \"M\",\n    \"6\": \"M\",\n    \"P\": \"z\",\n    \"Q\": \"z'\",\n    \"Z\": \"d\",\n    \"C\": \"u'\",\n    \",\": \"u\",\n    \"/\": \"d'\",\n    \"ENTER\": \"#enter\",\n    \" \": \"#space\",\n  }\n\nexport {defaultKeyMapping}","import React, { useEffect } from 'react'\n\nimport { FaceletCubeT } from \"../lib/Defs\";\nimport * as THREE from 'three';\n\ntype Config = {cube: FaceletCubeT, width: number, height: number, colorScheme: Array<number>}\n\n/*\nHow to propagate control of keypress ..? maybe not here, in the app.\n\nLet's look at click analogy: if a user click on sub-component,\nthat message should be propagated upwards to the parent.\n\nThat is, \"keydown\" should transform to some kind of message, e.g. the resulting cube state\nto be passed to the App, which then decides whether to trigger state change or let the cube keep being solved\n\n*/\n\n\ntype AxesInfo = [THREE.Vector3, THREE.Euler]\nconst TAU = Math.PI * 2;\nconst axesInfo : [THREE.Vector3, THREE.Euler][] = [\n    [new THREE.Vector3( 0,  1,  0), new THREE.Euler(-TAU/4,  0,  0)],\n    [new THREE.Vector3( 0, -1,  0), new THREE.Euler( TAU/4,  0,  0)],\n    [new THREE.Vector3( 0,  0,  1), new THREE.Euler( 0,  0,      0)],\n    [new THREE.Vector3( 0,  0, -1), new THREE.Euler( 0,  TAU/2,  0)],\n    [new THREE.Vector3(-1,  0,  0), new THREE.Euler( 0, -TAU/4,  0)],\n    [new THREE.Vector3( 1,  0,  0), new THREE.Euler( 0,  TAU/4,  0)],\n];\n\nconst setup = function(width: number, height: number, colorScheme?: Array<number>, mode?: string) {\n    const scene = new THREE.Scene()\n    const camera = new THREE.PerspectiveCamera(70, width / height, 0.1, 1000)\n    const renderer = new THREE.WebGLRenderer({ antialias: true })\n    const geo = new THREE.PlaneGeometry(0.9 * 2, 0.9 * 2)\n    const geo_border = new THREE.PlaneGeometry(1 * 2, 1 * 2)\n\n    //let colorScheme_ = colorScheme || [0xffffff, 0xffff00,  0x00ff00, 0x0000ff, 0xff8800, 0xff0000]\n\n    mode = mode || \"FRU\"\n\n    if (mode === \"FRU\")\n        camera.position.copy(new THREE.Vector3(2.2 / 1.1, 3/1.1, 3/1.1))\n    else\n        camera.position.copy(new THREE.Vector3(0 / 1.1, 3/1.1, 3/1.1))\n\n    //camera.position.copy(new THREE.Vector3(2.5, 5, 5))\n    camera.lookAt(new THREE.Vector3(0, 0, 0))\n\n\n    let stickers_tmpl: THREE.Mesh[] , stickerwrap_tmpl: THREE.Mesh\n\n    function updateColorScheme(colorScheme: Array<number>) {\n        let colorScheme_ = colorScheme\n        //console.log(\"update color scheme \", colorScheme_)\n        let materials = Array(7).fill(0).map( (_, i) => new THREE.MeshBasicMaterial({ color: colorScheme_[i], side:THREE.DoubleSide}))\n        let materials_border = new THREE.MeshBasicMaterial({ color: 0x000000, side:THREE.DoubleSide })\n        stickers_tmpl = materials.map( (mat) => {\n            let mesh = new THREE.Mesh(geo, mat)\n            mesh.setRotationFromEuler(axesInfo[0][1])\n            return mesh\n        })\n        stickerwrap_tmpl = (() => {\n            let mesh = new THREE.Mesh(geo_border, materials_border)\n            mesh.setRotationFromEuler(axesInfo[0][1])\n            return mesh\n        })()\n    }\n\n    function drawCube(faces: FaceletCubeT) : THREE.Group {\n        const cube = new THREE.Group();\n        for (let i = 0; i < 6; i++) {\n            const cubie = new THREE.Group();\n            const rot = new THREE.Matrix4().makeRotationFromEuler(axesInfo[i][1]);\n            const rot1 = new THREE.Matrix4().makeRotationFromEuler(axesInfo[1][1]);\n            cubie.setRotationFromMatrix(rot.multiply(rot1))\n            for (let z = -1; z <= 1; z++) {\n                for (let x = -1; x <= 1; x++) {\n                    let idx = (z + 1) * 3 + (x + 1)\n\n                    const curr_tmpl = stickers_tmpl[faces[i][idx]]\n                    const sticker = curr_tmpl.clone()\n                    const stickerwrap = stickerwrap_tmpl.clone()\n\n                    const eps = 0.04\n                    sticker.position.copy(new THREE.Vector3(x * 2, 3, z * 2))\n                    stickerwrap.position.copy(new THREE.Vector3(x * 2, 3 - eps, z * 2))\n\n                    if (i === 4 || i === 3 || i === 1 ||  (i === 5 && mode === \"UF\")) {\n                        const stickerhint = curr_tmpl.clone()\n                        stickerhint.position.copy(new THREE.Vector3(x * 2, 3 + 3 + 3, z * 2))\n                        cubie.add(stickerhint)\n                    }\n                    cubie.add(sticker)\n                    cubie.add(stickerwrap)\n                }\n            }\n            cube.add(cubie)\n        }\n        cube.scale.set(1/3, 1/3, 1/3)\n        return cube\n    }\n\n    let cubeG = new THREE.Group();\n    scene.add(cubeG)\n    const updateCube = (cube: FaceletCubeT) => {\n        scene.remove(cubeG)\n        cubeG = drawCube(cube)\n        scene.add(cubeG)\n    }\n\n    const renderScene = () => {\n        renderer.render(scene, camera)\n    }\n\n    const updateWidthHeight = (width: number, height: number) => {\n        renderer.setSize(width, height, false);\n        renderer.setClearColor('#fafafa')\n        camera.aspect = width / height;\n        camera.updateProjectionMatrix();\n    }\n\n\n    const cleanup = () => {\n        geo.dispose()\n        //materials.forEach(m => m.dispose())\n    }\n\n    //let defaultColorScheme = [ 0x00ff00, 0x0000ff, 0xff0000,0xff8800,0xffff00, 0xffffff]\n    updateWidthHeight(width, height)\n    //updateColorScheme(defaultColorScheme)\n    //updateCube(FaceletCube.from_cubie( CubieCube.id))\n\n\n    return {\n        domElement: () => {return renderer.domElement},\n        updateCube,\n        renderScene,\n        updateWidthHeight,\n        cleanup,\n        updateColorScheme\n    }\n}\n\nlet cubeSim = setup(370, 370)\n\nfunction CubeSim(props: Config) {\n  const mount = React.useRef<HTMLDivElement | null>(null)\n  let { width, height } = props\n\n  useEffect( () => {\n    let dom = cubeSim.domElement()\n    let current = mount.current!\n\n    current.appendChild(dom)\n    cubeSim.updateWidthHeight( width, height)\n    cubeSim.updateColorScheme(props.colorScheme)\n    cubeSim.updateCube(props.cube)\n    cubeSim.renderScene()\n\n    return () => {\n        current.removeChild( dom )\n    }\n  } )\n\n  return <div\n      ref = {mount}\n      style = {{width : props.width, height : props.height}}\n  />;\n}\n\nexport default CubeSim","let rand_int = (r: number) => {\n    return Math.floor(Math.random() * r)\n}\n\nlet rand_incl = (l: number, r: number) => {\n    return rand_int(r - l + 1) + l;\n}\nlet rand_choice = function<T>(arr: T[]) {\n    return arr[rand_int(arr.length)]\n}\n\nlet rand_shuffle = function<T>(arr: T[]) {\n    for (let i = 0, l = arr.length; i < l - 1; i++) {\n        let j = rand_incl(i, l - 1)\n        let tmp = arr[i];\n        arr[i] = arr[j];\n        arr[j] = tmp\n    }\n    return arr\n}\n\nlet getParity = (perm: number[]) => {\n    let visited = Array(perm.length).fill(false)\n    let follow = (i: number, cnt: number) : number => {\n        if (visited[i]) {\n            return 0\n        } else {\n            visited[i] = 1\n            return follow(perm[i], cnt + 1)\n        }\n    }\n    let res = 0\n    for (let x of perm) {\n        res += follow(x, 0)\n    }\n    return res\n}\n\nlet arrayEqual = function<T>(arr1: T[], arr2: T[]) {\n    if (arr1.length !== arr2.length) return false;\n    for (let i = 0; i < arr1.length; i++) {\n        if (arr1[i] !== arr2[i]) return false;\n    }\n    return true;\n}\n\nlet encodeArr = function(base: number, rarr: number[]) {\n    let int = 0\n    for (let i = rarr.length - 1; i >= 0; i--)\n        int = rarr[i] + int * base\n    return int\n}\n\nexport {rand_int, rand_choice, rand_shuffle, getParity, arrayEqual, encodeArr}","import { MoveT, CubieT, OriChg, PermChg } from \"./Defs\";\nimport { u, d, f, b, l, r, m, e } from \"./Defs\";\nimport { FaceletT, FaceletCubeT, corners_coord, edges_coord, u_face, f_face, color_map } from \"./Defs\";\nimport { Typ, Face, C, E, T, U, D, F, B, L, R } from \"./Defs\";\nimport { rand_int, rand_shuffle, getParity, rand_choice, arrayEqual } from \"./Math\";\n\nconst C_MOD = 3;\nconst E_MOD = 2;\nconst T_MOD = 1;\n\nlet CubieCube = (function () {\n    /*\n    Cube should be represented as a simple struct {cp, eo, ep, eo, tp}.\n    The addition of tp is not necessary, but helps us deal with slice moves in Roux during search and simcube.\n    */\n\n    /*\n    We will follow the programming pattern of returning an object with all the public functions.\n    These functions will mostly have no side effects, i.e. no 'this' will be used. instead, the object must pass itself\n    in as the first argument. This makes sense because cube moves usually changes the state representation by a lot,\n    and re-assigning the result to 'this' would be cumbersome.\n    */\n    let id: CubieT = {\n        // init state\n        cp: [0, 1, 2, 3, 4, 5, 6, 7],\n        co: [0, 0, 0, 0, 0, 0, 0, 0],\n        ep: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11],\n        eo: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\n        tp: [0, 1, 2, 3, 4, 5] // UD FB LR\n    }\n\n    let apply_partial = (o: Array<number>, p: Array<number>, oc: Array<OriChg>, pc: Array<PermChg>, mod: number) => {\n        let o_new = [...o];\n        let p_new = [...p];\n        console.assert(oc.length === pc.length)\n\n        for (let i = 0; i < oc.length; i++) {\n            //let [src, dst] = pc[i];\n            let src = pc[i][0], dst = pc[i][1];\n            p_new[dst] = p[src];\n            o_new[dst] = (o[src] + oc[i]) % mod;\n        }\n        return [o_new, p_new]\n    }\n\n    let apply_one = (cube: CubieT, move: MoveT) => {\n        let [co, cp] = apply_partial(cube.co, cube.cp, move.coc, move.cpc, C_MOD)\n        let [eo, ep] = apply_partial(cube.eo, cube.ep, move.eoc, move.epc, E_MOD)\n        let toc = Array(move.tpc.length).fill(0)\n        let [, tp] = apply_partial([0, 0, 0, 0, 0, 0], cube.tp, toc, move.tpc, T_MOD)\n        return ({ co, cp, eo, ep, tp })\n    }\n\n    let apply = (cube: CubieT, move: MoveT | Array<MoveT>) => {\n        if (Array.isArray(move)) {\n            for (let i = 0; i < move.length; i++) {\n                cube = apply_one(cube, move[i])\n            }\n            return cube\n        } else {\n            return apply_one(cube, move)\n        }\n    }\n\n    let from_move = (move: MoveT | Array<MoveT>) => {\n        return apply(id, move)\n    }\n\n\n    return {\n        id,\n        apply,\n        from_move\n    }\n\n})()\n\n\n/* Moves */\n/* We will generate all the moves based on the base moves and rotations, and return them in an array */\nlet Move = function () {\n    let from_cube = (cube: CubieT, name: string): MoveT => {\n        let get_change = (p: Array<number>, o: Array<number>, acc_p: Array<PermChg>, acc_o: Array<OriChg>) => {\n            for (let i = 0; i < p.length; i++) {\n                if (i === p[i] && o[i] === 0) {\n                } else {\n                    acc_p.push([p[i], i]);\n                    acc_o.push(o[i]);\n                }\n            }\n        }\n        let cpc: Array<PermChg> = [];\n        let coc: Array<OriChg> = [];\n        let epc: Array<PermChg> = [];\n        let eoc: Array<OriChg> = [];\n        let tpc: Array<PermChg> = [];\n        get_change(cube.cp, cube.co, cpc, coc);\n        get_change(cube.ep, cube.eo, epc, eoc);\n        get_change(cube.tp, [0, 0, 0, 0, 0, 0], tpc, []);\n        return {\n            cpc, coc, epc, eoc, tpc, name\n        }\n    }\n    let from_moves = (moves: Array<MoveT>, name: string): MoveT => {\n        let move = from_cube(CubieCube.apply(CubieCube.id, moves), name)\n        return move\n    }\n    let make_rot_set = (move: MoveT): Array<MoveT> => {\n        return [move,\n            from_moves([move, move], move.name + \"2\"),\n            from_moves([move, move, move], move.name + \"'\")\n        ]\n    }\n    let add_auf = (moves: Array<MoveT>, auf_moves?: Array<MoveT | MoveT[]>): MoveT[] => {\n        auf_moves = auf_moves || [[], Move.all[\"U\"], Move.all[\"U'\"], Move.all[\"U2\"]]\n        let auf_move = auf_moves[Math.floor(Math.random() * auf_moves.length)]\n        if (Array.isArray(auf_move)) {\n            return moves.concat(auf_move)\n        } else {\n            moves.push(auf_move)\n            return moves\n        }\n    }\n\n    let generate_base_moves = () => {\n        let us = make_rot_set(u);\n        let fs = make_rot_set(f)\n        let rs = make_rot_set(r)\n        let ls = make_rot_set(l)\n        let ds = make_rot_set(d)\n        let bs = make_rot_set(b)\n        let ms = make_rot_set(m)\n        let es = make_rot_set(e);\n\n        let rw = from_moves([r, ms[2]], \"r\")\n        let rws = make_rot_set(rw)\n        let lw = from_moves([l, m], \"l\")\n        let lws = make_rot_set(lw)\n        let uw = from_moves([u, e], \"u\")\n        let uws = make_rot_set(uw)\n\n        let x = from_moves([r, ls[2], ms[2]], \"x\")\n        let xs = make_rot_set(x)\n        let y = from_moves([u, e, ds[2]], \"y\")\n        let ys = make_rot_set(y)\n        let z = from_moves([x, y, x, x, x], \"z\")\n        let zs = make_rot_set(z)\n        let moves = [\n            us, fs, rs, ls, ds, bs, ms, es,\n            xs, ys, zs,\n            rws, lws, uws\n        ].flat()\n        let moves_dict: { [key: string]: MoveT } = Object.create({})\n        moves.forEach(m => moves_dict[m.name] = m)\n        return moves_dict\n    }\n\n    let all_moves = generate_base_moves()\n    let parse = (str: string) => {\n        str = str.replace(/2'/g, \"2\").replace(/2/g, \"2 \").replace(/'/g, \"' \");\n        let tokens = str.split(/\\s+/).filter(Boolean)\n        let res: MoveT[] = []\n        for (let token of tokens) {\n            let move = all_moves[token]\n            if (move) {\n                res.push(move)\n            } else {\n                return []\n                //throw Error(\"Invalid move sequence \" + move)\n            }\n        }\n        return res\n    }\n\n    let inv = (move: MoveT | MoveT[]): MoveT[] => {\n        if (Array.isArray(move)) {\n            return move.slice(0).reverse().map(inv).flat()\n        } else {\n            let name: string\n            switch (move.name[move.name.length - 1]) {\n                case \"'\": name = move.name.slice(0, move.name.length - 1); break\n                case \"2\": name = move.name; break\n                default: name = move.name + \"'\"\n            }\n            return [all_moves[name]]\n        }\n    }\n\n    let to_string = (move: MoveT | MoveT[]): string => {\n        if (Array.isArray(move)) {\n            return move.map(to_string).join(\" \")\n        } else {\n            return move.name\n        }\n    }\n\n    return {\n        all: all_moves,\n        parse: parse,\n        inv: inv,\n        add_auf: add_auf,\n        to_string: to_string,\n        from_moves\n    }\n}()\n\n/* Faces */\nlet FaceletCube = function () {\n    let mult_move = (face: FaceletT, move: MoveT): FaceletT => {\n        let face_new: FaceletT = [...face]\n        let mod_for_typ = (typ: Typ) => {\n            switch (typ) {\n                case C: return 3;\n                case E: return 2;\n                case T: return 1\n            }\n        }\n        let work = (p: PermChg, o: number, typ: Typ) => {\n            let mod = mod_for_typ(typ)\n            let [p1, p2] = p\n            for (let i = 0; i < face.length; i++) {\n                let [p_curr, o_curr, typ_curr] = face[i];\n                if (typ_curr === typ && p_curr === p1) {\n                    face_new[i] = [p2, (o_curr + o) % mod, typ]\n                }\n            }\n        }\n        for (let i = 0; i < move.cpc.length; i++) {\n            work(move.cpc[i], move.coc[i], C)\n        }\n        for (let i = 0; i < move.epc.length; i++) {\n            work(move.epc[i], move.eoc[i], E)\n        }\n        for (let i = 0; i < move.tpc.length; i++) {\n            work(move.tpc[i], 0, T)\n        }\n        return face_new\n    }\n    let color_of_c = (p: number, o1: number, o2: number) =>\n    corners_coord[p][(3 - o1 + o2) % 3];\n    let color_of_e = (p: number, o1: number, o2: number) =>\n        edges_coord[p][(2 - o1 + o2) % 2];\n    let color_of_t = (p: number) => [U, D, F, B, L, R][p]\n\n    let from_cubie_partial = (cube: CubieT, facelet: FaceletT) => {\n        return facelet.map(([p, o, typ]) => {\n            if (typ === C) {\n                return color_of_c(cube.cp[p], cube.co[p], o)\n            } else if (typ === E) {\n                return color_of_e(cube.ep[p], cube.eo[p], o)\n            } else if (typ === T) {\n                return color_of_t(cube.tp[p])\n            } else {\n                throw Error(\"unidentified type \" + typ)\n            }\n        })\n    }\n    let from_cubie_partial_masked = (cube: CubieT, facelet: FaceletT, mask: Mask) => {\n        return facelet.map(([p, o, typ]) => {\n            if (typ === C) {\n                if (mask.cp[cube.cp[p]] === 1)\n                    return color_of_c(cube.cp[p], cube.co[p], o)\n                else\n                    return Face.X\n            } else if (typ === E) {\n                if (mask.ep[cube.ep[p]] === 1)\n                    return color_of_e(cube.ep[p], cube.eo[p], o)\n                else\n                    return Face.X\n            } else if (typ === T) {\n                if (mask.tp && mask.tp[cube.tp[p]] === 0)\n                    return Face.X\n                else\n                    return color_of_t(cube.tp[p])\n            } else {\n                throw Error(\"unidentified type \" + typ)\n            }\n        })\n    }\n\n    let moves = Move.all\n    let generate_base_facelets = () => {\n        let d_face = mult_move(f_face, moves[\"x'\"])\n        let l_face = mult_move(f_face, moves[\"y\"])\n        let r_face = mult_move(f_face, moves[\"y'\"])\n        let b_face = mult_move(f_face, moves[\"y2\"])\n        return {\n            d_face, l_face, r_face, b_face\n        }\n    }\n    let { d_face, l_face, r_face, b_face } = generate_base_facelets()\n\n    let from_cubie = (cube: CubieT, mask?: Mask): FaceletCubeT => {\n        //console.log(\"converting from cube\", cube)\n        let faces = [u_face, d_face, f_face, b_face, l_face, r_face]\n        if (mask)\n            return faces.map((facelet) => from_cubie_partial_masked(cube, facelet, mask))\n        else\n            return faces.map((facelet) => from_cubie_partial(cube, facelet))\n    }\n\n    let to_unfolded_cube_str = (faceletCube: FaceletCubeT): String => {\n        let face_count = [0, 0, 0, 0, 0, 0];\n        let str_face_map: { [key: string]: Face } = {\n            \"U\": U, \"D\": D, \"F\": F, \"B\": B, \"L\": L, \"R\": R\n        }\n        let face_str_map = \"UDFBLR\"\n        let color_cube = \"\"\n        for (let i = 0; i < color_map.length; i++) {\n            let face_char = color_map[i];\n            if (str_face_map.hasOwnProperty(face_char)) {\n                let face: number = str_face_map[face_char] as number;\n                let count = face_count[face];\n                let color = faceletCube[face][count]\n                color_cube += face_str_map[color]\n                face_count[face] += 1;\n            } else {\n                color_cube += color_map[i];\n            }\n        }\n        return color_cube;\n    }\n\n    return {\n        from_cubie,\n        to_unfolded_cube_str\n    }\n}()\n\ntype Mask = {\n    co?: number[],\n    eo?: number[],\n    tp?: number[],\n    cp: number[],\n    ep: number[],\n}\n\nconst lse_mask: Mask = {\n    cp: [1, 1, 1, 1, 1, 1, 1, 1],\n    ep: [0, 0, 0, 0, 0, 1, 0, 1, 1, 1, 1, 1],\n}\nconst fs_back_mask: Mask = {\n    cp: [0, 0, 0, 0, 0, 1, 0, 0],\n    ep: [0, 0, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0]\n}\nconst fbdr_mask: Mask = {\n    cp: [0, 0, 0, 0, 1, 1, 0, 0],\n    ep: [0, 0, 0, 0, 0, 1, 0, 1, 1, 1, 0, 0],\n    tp: [0, 0, 0, 0, 1, 1]\n}\n\nlet CubeUtil = (() => {\n    let is_cube_solved = (cube: CubieT) => {\n        let id = CubieCube.id\n        return arrayEqual(cube.co, id.co) &&\n               arrayEqual(cube.eo, id.eo) &&\n               arrayEqual(cube.cp, id.cp) &&\n               arrayEqual(cube.ep, id.ep)\n    }\n    let is_mask_solved = (cube: CubieT, { co, eo, cp, ep }: Mask, premove: (MoveT | MoveT[])[]) => {\n        //let moves = [ [], Move.all[\"U\"], Move.all[\"U'\"], Move.all[\"U2\"] ]\n        co = co || cp\n        eo = eo || ep\n        for (let move of premove) {\n            let cube1 = CubieCube.apply(cube, move)\n            let solved = true\n            for (let i = 0; i < 8 && solved; i++) {\n                if ((co[i] && cube1.co[i] !== 0)\n                    || (cp[i] && cube1.cp[i] !== i)) {\n                    solved = false;\n                }\n            }\n            for (let i = 0; i < 12 && solved; i++) {\n                if ((eo[i] && cube1.eo[i] !== 0)\n                    || (ep[i] && cube1.ep[i] !== i)) {\n                    solved = false;\n                }\n            }\n            if (solved) return true;\n        }\n        return false;\n    }\n\n    const u_premove = [[], Move.all[\"U\"], Move.all[\"U'\"], Move.all[\"U2\"]]\n    const m_premove = [[], Move.all[\"M\"], Move.all[\"M'\"], Move.all[\"M2\"]]\n    const m2_premove = [[], Move.all[\"M2\"]]\n    //let m2u_premove = [[], Move.parse(\"U\"), Move.parse(\"U'\"), Move.parse(\"U2\"),\n    //Move.parse(\"M2\"), Move.parse(\"M2U\"), Move.parse(\"M2U'\"), Move.parse(\"M2U2\")]\n\n    let is_cmll_solved = (cube: CubieT) => {\n        return is_mask_solved(cube, lse_mask, u_premove)\n    }\n\n    let get_random_with_mask = ({ co, eo, cp, ep }: Mask): CubieT => {\n        co = co || cp\n        eo = eo || ep\n        // get_random -- figure out which masks are 0, and assign random to these\n        let random_ori = (ori_mask: number[], typ: Typ) => {\n            let ori = Array(ori_mask.length).fill(0)\n            let mod = (typ === C) ? 3 : 2\n            let sum: number\n            do {\n                sum = 0\n                for (let i in ori_mask) {\n                    if (ori_mask[i] === 0) {\n                        ori[i] = rand_int(mod)\n                        sum += ori[i]\n                    }\n                }\n            } while (sum % mod > 0)\n            return ori\n        }\n        let random_perm = (perm_mask: number[]) => {\n            let perm: number[] = Array(perm_mask.length).fill(0)\n            let undecided: number[] = []\n            for (let i = 0; i < perm_mask.length; i++) {\n                if (perm_mask[i] === 0) {\n                    undecided.push(i)\n                } else {\n                    perm[i] = i\n                }\n            }\n            rand_shuffle(undecided)\n            for (let i = 0, cnt = 0; i < perm_mask.length; i++) {\n                if (perm_mask[i] === 0) {\n                    perm[i] = undecided[cnt]\n                    cnt += 1\n                }\n            }\n            return perm\n        }\n        let cp_rand, ep_rand, par\n        do {\n            [cp_rand, ep_rand] = [random_perm(cp), random_perm(ep)]\n            par = (getParity(cp_rand) + getParity(ep_rand)) & 1\n        } while (par > 0)\n\n        return {\n            co: random_ori(co, C),\n            cp: cp_rand,\n            eo: random_ori(eo, E),\n            ep: ep_rand,\n            tp: [0, 1, 2, 3, 4, 5]\n        }\n    }\n\n    let get_random_lse = (): CubieT => {\n        let cube = get_random_with_mask(lse_mask)\n        return CubieCube.apply(cube, rand_choice(m2_premove))\n    }\n\n    let get_random_fs = (): CubieT => {\n        let cube = get_random_with_mask(fs_back_mask)\n        return CubieCube.apply(cube, rand_choice(m_premove))\n    }\n\n    const ori_to_color_scheme = (() => {\n        // UDFBLR\n        // specify the colors for uf\n        // how to do this?\n        const arr: [string, number][] = [\n            [\"G\", 0x00ff00],\n            [\"B\", 0x0000ff],\n            [\"R\", 0xff0000],\n            [\"O\", 0xff8800],\n            [\"Y\", 0xffff00],\n            [\"W\", 0xffffff],\n            [\"X\", 0xcccccc]\n        ]\n        const colorMap = new Map<string, number>(arr)\n        // UDFBLR from UF\n        // INFERR UFR from UF?\n        const valid_schemes = [\n            \"WYGBOR\",\n            \"WYBGRO\",\n            \"WYROGB\",\n            \"WYORBG\",\n            \"YWGBRO\",\n            \"YEBGOR\",\n            \"YWROBG\",\n            \"YWORGB\",\n\n            \"GBWYRO\",\n            \"GBYWOR\",\n            \"GBROYW\",\n            \"GBORWY\",\n            \"BGWYOR\",\n            \"BGYWRO\",\n            \"BGROWY\",\n            \"BGORYW\",\n\n            \"ORWYGB\",\n            \"ORYWBG\",\n            \"ORGBWY\",\n            \"ORBGYW\",\n            \"ROWYBG\",\n            \"ROYWGB\",\n            \"ROGBYW\",\n            \"ROBGWY\",\n        ]\n        const valid_scheme_mapper: { [key: string]: number[] } = Object.create({})\n        valid_schemes.forEach(s => {\n            let arr = s.split('').map(ch => colorMap.get(ch)!)\n            arr.push(colorMap.get(\"X\")!)\n            valid_scheme_mapper[s[0] + s[2]] = arr\n        })\n\n        const mapper = (sel: string) => {\n            return valid_scheme_mapper[sel]\n        }\n\n        return mapper\n    })()\n\n    return {\n        is_cmll_solved,\n        get_random_lse,\n        get_random_fs,\n        ori_to_color_scheme,\n        is_cube_solved,\n    }\n})()\n\nlet Mask = {\n    lse_mask, fs_back_mask, fbdr_mask\n}\n\nexport { CubieCube, Move, FaceletCube, CubeUtil, Mask }","import React from 'react'\n\nimport CubeSim from './CubeSim'\nimport { Checkbox, FormControlLabel, FormGroup, makeStyles } from '@material-ui/core';\nimport Container from '@material-ui/core/Container';\nimport Grid from '@material-ui/core/Grid';\nimport Paper from '@material-ui/core/Paper';\nimport Box from '@material-ui/core/Box';\nimport { FaceletCube, CubeUtil } from '../lib/CubeLib';\n\nimport { AppState, Selector, Action, Config } from \"../Types\";\nimport 'typeface-roboto';\nimport clsx from 'clsx';\n\n\nconst useStyles = makeStyles(theme => ({\n    container: {\n      paddingTop: theme.spacing(2),\n      paddingBottom: theme.spacing(2),\n    },\n    paper: {\n      padding: theme.spacing(2),\n      display: 'flex',\n      overflow: 'auto',\n      flexDirection: 'column',\n    },\n    fixedHeight: {\n      height: 420,\n    },\n    canvasPaper: {\n      padding: theme.spacing(0),\n      display: 'flex',\n      overflow: 'auto',\n      flexDirection: 'column',\n    },\n    title : {\n        flexGrow: 1,\n    }\n  }))\n\n\n\nfunction SelectorGroupPanel(props: { selector: Selector, handleChange: (x: string) => () => void }) {\n    let { selector, handleChange } = props\n    var makeBox = (name: string, checked: boolean) => {\n        return (\n        <FormControlLabel\n            control={\n            <Checkbox checked={checked} onChange={handleChange(name)} />\n            }\n            label={name}\n            color=\"primary\"\n            key={name}\n        />)\n    }\n    return (\n        <FormGroup row>\n        {selector.names.map( (name, i) => makeBox(name, !!selector.flags[i]) ) }\n        </FormGroup>\n    );\n}\n\nfunction CmllTrainerView(props: { state: AppState, dispatch: React.Dispatch<Action> } ) {\n    let { state, dispatch } = props\n    let cube = state.cube.state\n    let config = state.config\n    let classes = useStyles()\n    const canvasPaper = clsx(classes.canvasPaper, classes.fixedHeight);\n    let facelet = FaceletCube.from_cubie(cube)\n\n\n    const handleSelectorChange = React.useCallback( (selectorSel: (x: Config) => Selector) => (name: string) => {\n        return function () {\n          let {names , flags} = selectorSel(config)\n          let new_flags = [...flags]\n          let idx = names.indexOf(name)\n          if (0 <= idx && idx < new_flags.length) {\n            new_flags[idx] = 1 - new_flags[idx]\n          }\n\n          let new_config = {...config}\n          let sel = selectorSel(new_config)\n          sel.flags = new_flags\n          //console.log(\"setting new config to \")\n          dispatch( { type: \"config\", content: new_config })\n        }\n      }, [ config, dispatch ] )\n\n    return (\n    <Container maxWidth=\"lg\" className={classes.container}>\n    <Grid container spacing={3} justify=\"center\" alignItems=\"center\">\n      <Grid item xs={12} md={10} lg={8} >\n            <Paper className={canvasPaper}>\n              <Box margin=\"auto\">\n              <CubeSim\n                width={400}\n                height={400}\n                cube={facelet}\n                colorScheme={CubeUtil.ori_to_color_scheme(props.state.cube.ori)}\n              />\n              </Box>\n            </Paper>\n      </Grid>\n    </Grid>\n    <Grid container spacing={3} justify=\"center\" alignItems=\"center\">\n      <Grid item xs={12} md={10} lg={8}>\n        <SelectorGroupPanel selector={ config.cmllSelector } handleChange= {handleSelectorChange(d => d.cmllSelector)} />\n      </Grid>\n      <Grid item xs={12} md={10} lg={8}>\n        <SelectorGroupPanel selector={ config.cmllAufSelector } handleChange= {handleSelectorChange(d => d.cmllAufSelector)} />\n      </Grid>\n      <Grid item xs={12} md={10} lg={8}>\n        <SelectorGroupPanel selector={ config.triggerSelector } handleChange= {handleSelectorChange(d => d.triggerSelector)} />\n      </Grid>\n      <Grid item xs={12} md={10} lg={8}>\n        <SelectorGroupPanel selector={ config.orientationSelector } handleChange= {handleSelectorChange(d => d.orientationSelector)} />\n      </Grid>\n    </Grid>\n    </Container>\n    );\n}\n\nexport default CmllTrainerView\n\n\n","import React from 'react'\n\nimport CubeSim from './CubeSim'\nimport { Checkbox, FormControlLabel, FormGroup, Button, makeStyles, Divider, Typography, FormControl, FormLabel, RadioGroup } from '@material-ui/core';\nimport Container from '@material-ui/core/Container';\nimport Grid from '@material-ui/core/Grid';\nimport Radio from '@material-ui/core/Radio';\nimport Paper from '@material-ui/core/Paper';\nimport Box from '@material-ui/core/Box';\nimport { FaceletCube, CubeUtil, Mask } from '../lib/CubeLib';\n\nimport { AppState, Selector, Action, Config } from \"../Types\";\nimport 'typeface-roboto';\nimport clsx from 'clsx';\n\n\nconst useStyles = makeStyles(theme => ({\n    container: {\n      paddingTop: theme.spacing(2),\n      paddingBottom: theme.spacing(2),\n\n    },\n    button: {\n      margin: theme.spacing(1),\n    },\n    paper: {\n      padding: theme.spacing(2),\n      display: 'flex',\n      overflow: 'auto',\n      flexDirection: 'column',\n    },\n    canvasPaper: {\n      padding: theme.spacing(0),\n      display: 'flex',\n      overflow: 'auto',\n      flexDirection: 'column',\n    },\n    infoColumn: {\n      color: \"gray\" //theme.palette.background.paper\n    },\n    textColumn: {\n      color: \"black\"\n    },\n    fixedHeight: {\n      height: 250,\n    },\n    title : {\n        flexGrow: 1,\n    },\n\n  }))\n\n\n\nfunction FbdrTrainerView(props: { state: AppState, dispatch: React.Dispatch<Action> } ) {\n    let { state, dispatch } = props\n    let cube = state.cube.state\n    let config = state.config\n    let classes = useStyles()\n    let facelet = FaceletCube.from_cubie(cube, Mask.fbdr_mask)\n\n    let desc = state.case.desc[0] || { alg: \"\", setup:\"Press space for new case\"}\n    let { alg, setup, alt_algs } = desc\n    //let alg_str = (alt_algs || []).join(\"\\n\")\n\n    let spaceButtonText = (state.name === \"hiding\") ? \"Reveal\" : \"Next\"\n    let enterButtonText = \"Reveal All\"\n\n    let algText = (state.name === \"hiding\") ? \"-\" :\n      (state.name === \"revealed\") ? alg : alg + \"\\n\" + (alt_algs || []).join(\"\\n\")\n\n    const handleSpace = () => {\n      dispatch({type: \"key\", content: \"#space\"})\n    }\n    const handleEnter = () => {\n      dispatch({type: \"key\", content: \"#enter\"})\n    }\n    const handleChange = (evt: { target: { value: string; }; }) => {\n      let { names } = state.config.fbdrSelector\n      let n = names.length\n      let new_flags = Array(n).fill(0)\n\n      for (let i = 0; i < names.length; i++) {\n        if (names[i] === evt.target.value) {\n          new_flags[i] = 1\n        }\n      }\n      let new_config = {...config, fbdrSelector: {...state.config.fbdrSelector, flags: new_flags}}\n      dispatch( { type: \"config\", content: new_config })\n    }\n    let sel = state.config.fbdrSelector\n    let radioValue = function() {\n      let { names, flags } = sel\n      for (let i = 0; i < flags.length; i++) {\n        if (flags[i] === 1) return names[i]\n      }\n      return \"\"\n    }()\n\n    return (\n    <Box className={classes.container}>\n      <Container maxWidth=\"sm\" className={classes.container}>\n\n      <Grid container>\n        <Grid item xs={12}>\n        <Paper className={ clsx(classes.canvasPaper, classes.fixedHeight) }>\n          <Box margin=\"auto\">\n            <CubeSim\n              width={250}\n              height={250}\n              cube={facelet}\n              colorScheme={CubeUtil.ori_to_color_scheme(props.state.cube.ori)}\n            />\n          </Box>\n        </Paper>\n        </Grid>\n      </Grid>\n\n      <Paper className={classes.paper} elevation={2}>\n      <Grid container spacing={2}>\n        <Grid item xs={12} sm={6}>\n        <Grid container spacing={3} justify=\"center\" alignItems=\"center\">\n          <Grid item xs={12} className={classes.infoColumn} >\n            <Box display=\"flex\">\n              <Box fontWeight={500} border={3} borderTop={0} borderLeft={0} borderRight={0}\n                   color=\"primary.main\" borderColor=\"primary.main\">\n                Scramble\n              </Box>\n            </Box>\n          </Grid>\n\n          <Grid item xs={12} className={classes.textColumn} >\n            <Box paddingBottom={3} lineHeight={2} fontSize={20} fontWeight={400}>\n              {setup}\n            </Box>\n          </Grid>\n        </Grid>\n        </Grid>\n\n        <Grid item xs={12} sm={6}>\n        <Grid container spacing={3} justify=\"center\" alignItems=\"center\">\n          <Grid item xs={12}className={classes.infoColumn} >\n            <Box display=\"flex\" >\n                <Box fontWeight={500} border={3} borderTop={0} borderLeft={0} borderRight={0}\n                    color=\"primary.main\" borderColor=\"primary.main\">\n                  Solution\n                </Box>\n            </Box>\n          </Grid>\n\n          <Grid item xs={12} className={classes.textColumn} >\n            <Box paddingBottom={3} lineHeight={2} fontSize={20} fontWeight={400}>\n              <Typography style={{whiteSpace: 'pre-line'}} >\n                {algText}\n              </Typography>\n            </Box>\n\n          </Grid>\n        </Grid>\n        </Grid>\n\n      </Grid>\n\n      <Grid container spacing={2}>\n        <Grid item xs={6}>\n          <Button className={classes.button} size=\"medium\" variant=\"contained\" color=\"primary\" onClick={handleSpace}> { /* className={classes.margin}>  */ }\n              {spaceButtonText}\n          </Button>\n          <Button className={classes.button} size=\"medium\" variant=\"contained\" color=\"primary\" onClick={handleEnter}> { /* className={classes.margin}>  */ }\n              {enterButtonText}\n          </Button>\n        </Grid>\n      </Grid>\n\n      </Paper>\n\n      <Box height={20}/>\n      <Divider/>\n      <Box height={20}/>\n        <FormControl component=\"fieldset\">\n          <FormLabel component=\"legend\">Position of last pair</FormLabel>\n          <RadioGroup aria-label=\"position\" name=\"position\" value={radioValue} onChange={handleChange} row>\n            {\n              sel.names.map(name => (\n                <FormControlLabel\n                  key={name}\n                  value={name}\n                  control={<Radio color=\"primary\" />}\n                  label={name}\n                  labelPlacement=\"end\"\n                />\n              ))\n            }\n          </RadioGroup>\n        </FormControl>\n      </Container>\n</Box>\n\n\n\n\n    );\n}\n\nexport default FbdrTrainerView\n\n\n","import React from 'react'\nimport { AppState, Mode, Action } from \"../Types\";\n\nimport { Box, AppBar, Typography, Tabs, Tab, makeStyles } from '@material-ui/core';\n\nimport CmllTrainerView from './CmllTrainerView';\nimport FbdrTrainerView from './FbdrTrainerView';\n\n\ninterface TabPanelProps {\n  value: number,\n  index: number,\n  children: any,\n  [key: string]: any\n}\nfunction TabPanel(props: TabPanelProps ) {\n  const { children, value, index, ...other } = props;\n\n  return (\n    <Typography\n      component=\"div\"\n      role=\"tabpanel\"\n      hidden={value !== index}\n      id={`simple-tabpanel-${index}`}\n      aria-labelledby={`simple-tab-${index}`}\n      {...other}\n    >\n      {value === index && <Box p={3}>{children}</Box>}\n    </Typography>\n  );\n}\nconst useStyles = makeStyles(theme => ({\n  page: {\n    backgroundColor: \"#eee\"\n  }\n}))\n\n// TODO: Write getter and setter for config items, and also write handlers that map to setters\nfunction AppView(props: { state: AppState, dispatch: React.Dispatch<Action> } ) {\n  //const [locations, setLocations] = React.useState([])\n  let { state, dispatch } = props\n  let classes = useStyles()\n\n  const handleChange = React.useCallback( (_:any, newValue:number) => {\n    setValue(newValue)\n    let modes : Mode[] = [\"cmll\", \"fbdr\"]\n    let mode = modes[newValue]\n    dispatch({type: \"mode\", content: mode})\n  }, [dispatch])\n  const [value, setValue] = React.useState(1);\n  return (\n    <main>\n      <AppBar position=\"static\">\n        <Tabs value={value} onChange={handleChange} aria-label=\"simple tabs example\">\n          <Tab label=\"CMLL Trainer\" id='tab0'/>\n          <Tab label=\"FBDR Trainer\" id='tab1' />\n        </Tabs>\n      </AppBar>\n      <TabPanel value={value} index={0} className={classes.page}>\n        <CmllTrainerView {...{state, dispatch}} />\n      </TabPanel>\n      <TabPanel value={value} index={1} className={classes.page}>\n        <FbdrTrainerView {...{state, dispatch}} />\n      </TabPanel>\n\n    </main>\n  )\n}\nexport default AppView","// source: \"https://sites.google.com/view/kianroux/cmll\" and https://github.com/AshleyF/briefcubing/blob/master/algs.js\n\n//type oll_case = \"o\"|\"h\"|\"pi\"|\"u\"|\"t\"|\"s\"|\"as\"|\"l\"\nimport { Selector } from \"../Types\";\nimport { rand_choice } from \"./Math\";\n\nconst get_active_names = (sel : Selector) => {\n    let res = []\n    for (let i = 0; i < sel.names.length; i++) {\n        if (sel.flags[i]) {\n            res.push(sel.names[i]);\n        }\n    }\n    return res\n}\n\nexport type AlgDesc = {\n    id: string,\n    alg: string,\n    alt_algs?: string[],\n    setup?: string,\n    kind: string\n}\n\nconst empty_alg : AlgDesc = {\n    id: \"empty\",\n    alg: \"\",\n    kind: \"any\"\n}\n\nconst cmll_algs : AlgDesc[] = [\n    { id: \"o_adjacent_swap\", alg: \"R U R' F' R U R' U' R' F R2 U' R'\", kind: \"cmll\" },\n    { id: \"o_diagonal_swap\", alg: \"r2 D r' U r D' R2 U' F' U' F\", kind: \"cmll\" },\n    { id: \"h_columns\", alg: \"R U R' U R U' R' U R U2 R'\", kind: \"cmll\" },\n    { id: \"h_rows\", alg: \"F R U R' U' R U R' U' R U R' U' F'\", kind: \"cmll\" },\n    { id: \"h_column\", alg: \"U R U2' R2' F R F' U2 R' F R F'\", kind: \"cmll\" },\n    { id: \"h_row\", alg: \"r U' r2' D' r U' r' D r2 U r'\", kind: \"cmll\" },\n    { id: \"pi_right_bar\", alg: \"F R U R' U' R U R' U' F'\", kind: \"cmll\" },\n    { id: \"pi_back_slash\", alg: \"U F R' F' R U2 R U' R' U R U2' R'\", kind: \"cmll\" },\n    { id: \"pi_x_checkerboard\", alg: \"U' R' F R U F U' R U R' U' F'\", kind: \"cmll\" },\n    { id: \"pi_forward_slash\", alg: \"R U2 R' U' R U R' U2' R' F R F'\", kind: \"cmll\" },\n    { id: \"pi_columns\", alg: \"U' r U' r2' D' r U r' D r2 U r'\", kind: \"cmll\" },\n    { id: \"pi_left_bar\", alg: \"U' R' U' R' F R F' R U' R' U2 R\", kind: \"cmll\" },\n    { id: \"u_forward_slash\", alg: \"U2 R2 D R' U2 R D' R' U2 R'\", kind: \"cmll\" },\n    { id: \"u_back_slash\", alg: \"R2' D' R U2 R' D R U2 R\", kind: \"cmll\" },\n    { id: \"u_front_row\", alg: \"R2' F U' F U F2 R2 U' R' F R\", kind: \"cmll\" },\n    { id: \"u_rows\", alg: \"U' F R2 D R' U R D' R2' U' F'\", kind: \"cmll\" },\n    { id: \"u_x_checkerboard\", alg: \"U2 r U' r' U r' D' r U' r' D r\", kind: \"cmll\" },\n    { id: \"u_back_row\", alg: \"U' F R U R' U' F'\", kind: \"cmll\" },\n    { id: \"t_left_bar\", alg: \"U' R U R' U' R' F R F'\", kind: \"cmll\" },\n    { id: \"t_right_bar\", alg: \"U L' U' L U L F' L' F\", kind: \"cmll\" },\n    { id: \"t_rows\", alg: \"F R' F R2 U' R' U' R U R' F2\", kind: \"cmll\" },\n    { id: \"t_front_row\", alg: \"r' U r U2' R2' F R F' R\", kind: \"cmll\" },\n    { id: \"t_back_row\", alg: \"r' D' r U r' D r U' r U r'\", kind: \"cmll\" },\n    { id: \"t_columns\", alg: \"U2 r2' D' r U r' D r2 U' r' U' r\", kind: \"cmll\" },\n    { id: \"s_left_bar\", alg: \"U R U R' U R U2 R'\", kind: \"cmll\" },\n    { id: \"s_x_checkerboard\", alg: \"U L' U2 L U2' L F' L' F\", kind: \"cmll\" },\n    { id: \"s_forward_slash\", alg: \"U F R' F' R U2 R U2' R'\", kind: \"cmll\" },\n    { id: \"s_Columns\", alg: \"U2 R' U' R U' R2' F' R U R U' R' F U2' R\", kind: \"cmll\" },\n    { id: \"s_right_bar\", alg: \"U' R U R' U R' F R F' R U2' R'\", kind: \"cmll\" },\n    { id: \"s_back_slash\", alg: \"U R U' L' U R' U' L\", kind: \"cmll\" },\n    { id: \"as_right_bar\", alg: \"U R' U' R U' R' U2' R\", kind: \"cmll\" },\n    { id: \"as_columns\", alg: \"U' R2 D R' U R D' R' U R' U' R U' R'\", kind: \"cmll\" },\n    { id: \"as_back_slash\", alg: \"U' F' L F L' U2' L' U2 L\", kind: \"cmll\" },\n    { id: \"as_x_checkerboard\", alg: \"U' R U2' R' U2 R' F R F'\", kind: \"cmll\" },\n    { id: \"as_forward_slash\", alg: \"U' L' U R U' L U R'\", kind: \"cmll\" },\n    { id: \"as_left_bar\", alg: \"U' R' U' R U' L U' R' U L' U2 R\", kind: \"cmll\" },\n    { id: \"l_mirror\", alg: \"F R U' R' U' R U R' F'\", kind: \"cmll\" },\n    { id: \"l_inverse\", alg: \"F R' F' R U R U' R'\", kind: \"cmll\" },\n    { id: \"l_pure\", alg: \"R U2 R' U' R U R' U' R U R' U' R U' R'\", kind: \"cmll\" },\n    { id: \"l_front_commutator\", alg: \"R U2 R D R' U2 R D' R2'\", kind: \"cmll\" },\n    { id: \"l_diag\", alg: \"R' U' R U R' F' R U R' U' R' F R2\", kind: \"cmll\" },\n    { id: \"l_back_commutator\", alg: \"U R' U2 R' D' R U2 R' D R2\", kind: \"cmll\" }\n]\n\nlet trigger_algs: AlgDesc[] = [\n    { id: \"RUR'_1\", alg: \"R U R'\", kind:\"trigger\"},\n    { id: \"RUR'_2\", alg: \"r U r'\", kind:\"trigger\"},\n    { id: \"RU'R'_1\", alg: \"R U' R'\", kind:\"trigger\"},\n    { id: \"RU'R'_2\", alg: \"r U' r'\", kind:\"trigger\"},\n    { id: \"R'U'R_1\", alg: \"R' U' R\", kind:\"trigger\"},\n    { id: \"R'U'R_2\", alg: \"r' U' r\", kind:\"trigger\"},\n    { id: \"R'UR_1\", alg: \"R' U R\", kind:\"trigger\"},\n    { id: \"R'UR_2\", alg: \"r' U r\", kind:\"trigger\"}\n]\n\nlet u_auf_algs: AlgDesc[] = [\n    { id: \"U\", alg: \"U\", kind: \"u_auf\"},\n    { id: \"U'\", alg: \"U'\", kind: \"u_auf\"},\n    { id: \"U2\", alg: \"U2\", kind: \"u_auf\"},\n    { id: \"None\", alg: \"\", kind: \"u_auf\"},\n]\n\nlet ori_algs: AlgDesc[] =\n    [\"WG\", \"WB\", \"WO\", \"WR\",\n    \"YG\", \"YB\", \"YO\", \"YR\",\n    \"BW\", \"BY\", \"BO\", \"BR\",\n    \"GW\", \"GY\", \"GO\", \"GR\",\n    \"OW\", \"OY\", \"OB\", \"OG\",\n    \"RW\", \"RY\", \"RB\", \"RG\"].map(s => ({id: s, alg: \"\", kind:\"orientation\" }))\n\nlet lookup_algset = (kind : string) => {\n    switch (kind) {\n        case \"cmll\": return cmll_algs;\n        case \"trigger\": return trigger_algs;\n        case \"orientation\": return ori_algs;\n        case \"u_auf\": return u_auf_algs;\n        default: return []\n    }\n}\n\nlet alg_generator = (selector: Selector) => {\n    let algSet = lookup_algset(selector.kind)\n    let lookup = new Set(get_active_names(selector))\n    let get_prefix = (id: string) => {\n        return id.split(\"_\", 1)[0]\n    }\n    let algs : AlgDesc[] = (() => {\n        return algSet.filter(alg => {\n            let prefix = get_prefix(alg.id);\n            return lookup.has(prefix)\n        })\n    })()\n\n    let next = () => {\n        if (algs.length === 0) {\n            return empty_alg\n        } else {\n            return rand_choice(algs)\n        }\n    }\n    return next\n}\n\nexport { alg_generator }","import { Config } from \"../Types\"\nimport { version } from \"../Version\"\n\nconst initialConfig : Config = (() => {\n    let arr_ori_flag = Array(24).fill(0)\n    arr_ori_flag[0] = 1\n    return {\n        cmllSelector: {\n            names: [\"o\", \"s\", \"as\", \"t\", \"l\", \"u\", \"pi\", \"h\"],\n            flags: [1, 1, 1, 1, 1, 1, 1, 1],\n            kind: \"cmll\",\n        },\n        cmllAufSelector: {\n            names: [\"None\", \"U\", \"U'\", \"U2\"],\n            flags: [1, 1, 1, 1],\n            kind: \"u_auf\"\n        },\n        triggerSelector: {\n            names: [\"RUR'\", \"RU'R'\", \"R'U'R\", \"R'UR\"],\n            flags: [1,1,1,1],\n            kind: \"trigger\"\n        },\n        orientationSelector: {\n            names: [\n                \"WG\", \"WB\", \"WO\", \"WR\",\n                \"YG\", \"YB\", \"YO\", \"YR\",\n                \"BW\", \"BY\", \"BO\", \"BR\",\n                \"GW\", \"GY\", \"GO\", \"GR\",\n                \"OW\", \"OY\", \"OB\", \"OG\",\n                \"RW\", \"RY\", \"RB\", \"RG\",\n            ],\n            flags: arr_ori_flag,\n            kind: \"orientation\"\n        },\n        fbdrSelector: {\n            names: [\"FP at front\", \"FP at back(unavailable yet)\", \"Both\"],\n            flags: [1, 0, 0],\n            kind: \"fbdr\"\n        }\n    }\n})()\n\nlet configManager = function() {\n    const key = \"config\"\n    const versionKey = \"version\"\n    let cache : Config | null = null\n\n    let getConfig = () => {\n        if (cache) {\n            return cache\n        }\n        const item = window.localStorage.getItem(key);\n        const vers = window.localStorage.getItem(versionKey)\n        if ( (vers === null) || (vers === undefined) || (vers !== version)) {\n            window.localStorage.setItem(versionKey, version)\n            window.localStorage.setItem(key, JSON.stringify(initialConfig));\n            return initialConfig\n        }\n        const item1 : Config = item ? JSON.parse(item) : initialConfig\n        if ( (item1 === null) || (item1 === undefined) || Object.keys(item1).length === 0) {\n            window.localStorage.setItem(key, JSON.stringify(initialConfig));\n            return initialConfig\n        }\n        return item1\n    }\n\n    let setConfig = (partial: Partial<Config>) => {\n        let newConfig : Config = Object.assign(getConfig(), partial)\n        window.localStorage.setItem(key, JSON.stringify(newConfig));\n        cache = newConfig\n    }\n\n    return {\n        getConfig,\n        setConfig\n    }\n}()\n\nlet getConfig = configManager.getConfig\nlet setConfig = configManager.setConfig\n\nexport {\n    getConfig, setConfig\n}\n","const version = \"0.2\"\n\nexport {version}","import { CubieCube, CubeUtil, Move } from './CubeLib';\nimport { CubieT, MoveT } from './Defs';\nimport { DepthModes, ShaderChunk } from 'three';\nimport { arrayEqual } from './Math';\nexport type PrunerConfig = {\n    size: number,\n    encode: (cube : CubieT) => number,\n    solved_states: CubieT[],\n    max_depth: number,\n    moveset: MoveT[]\n}\nexport type PrunerT = {\n    init: () => void,\n    query: (c : CubieT) => number,\n    equal: (c1 : CubieT, c2: CubieT) => boolean\n}\n\nexport function Pruner(config: PrunerConfig) : PrunerT {\n    let dist: Uint8Array;\n    let { size, encode, solved_states, max_depth, moveset} = config\n    let initialized = false\n    function init() {\n        if (initialized) return\n        initialized = true\n        dist = new Uint8Array(size).fill(255)\n        for (let state of solved_states) {\n            dist[encode(state)] = 0\n        }\n        let frontier = [...solved_states]\n        let total_expanded = frontier.length\n        for (let i = 0; i < max_depth; i++) {\n            console.log(\"pruner: expanding depth \", i)\n            let new_frontier = []\n            for (let state of frontier) {\n                for (let move of moveset) {\n                    let newState = CubieCube.apply(state, move)\n                    let idx = encode(newState)\n                    if (dist[idx] === 255) {\n                        dist[idx] = i + 1;\n                        new_frontier.push(newState)\n                    }\n                }\n            }\n            frontier = new_frontier\n            total_expanded += frontier.length\n        }\n        console.log(\"Initialization complete. size = \", total_expanded)\n    }\n    function query(cube: CubieT) {\n        let d = dist[encode(cube)]\n        if (d === 255) return max_depth + 1;\n        return d\n    }\n    function equal(cube1: CubieT, cube2: CubieT) {\n        return encode(cube1) === encode(cube2)\n    }\n    return  {\n        init,\n        query,\n        equal\n    }\n}\n\nlet fbdrPrunerConfig : PrunerConfig = function() {\n    const esize = Math.pow(24, 4)\n    const csize = Math.pow(24, 2)\n    const size = esize * csize\n\n    function encode(cube:CubieT) {\n      let c1 = 0, c2 = 0\n      for (let i = 0; i < 8; i++) {\n        if (cube.cp[i] === 4) {\n          c1 = i * 3 + cube.co[i]\n        } else if (cube.cp[i] === 5) {\n          c2 = i * 3 + cube.co[i];\n        }\n      }\n      const enc_c = c1 * 24 + c2\n      let e1 = 0, e2 = 0, e3 = 0, e4 = 0\n      for (let i = 0; i < 12; i++) {\n          switch (cube.ep[i]) {\n              case 5 : e1 = i * 2 + cube.eo[i]; break;\n              case 8 : e2 = i * 2 + cube.eo[i]; break;\n              case 9 : e3 = i * 2 + cube.eo[i]; break;\n              case 7 : e4 = i * 2 + cube.eo[i]; break;\n          }\n      }\n      const enc_e = e1 * (24 * 24 * 24) + e2 * (24 * 24) + e3 * 24 + e4\n      return enc_c + 24 * 24 * enc_e\n    }\n\n    const moves = [[], Move.parse(\"L R'\"), Move.parse(\"L' R\"), Move.parse(\"L2 R2\")]\n    const solved_states = moves.map( (move : MoveT[]) => CubieCube.apply(CubieCube.id, move))\n\n    const max_depth = 5\n    const moveset : MoveT[] = [\"U\", \"U2\", \"U'\", \"F\", \"F2\", \"F'\", \"R\", \"R2\", \"R'\",\n    \"r\", \"r2\", \"r'\", \"D\", \"D2\", \"D'\", \"M\", \"M'\", \"M2\"].map(s => Move.all[s])\n\n    return {\n        size,\n        encode,\n        solved_states,\n        max_depth,\n        moveset\n    }\n}()\n\nexport { fbdrPrunerConfig }","import { CubieCube, CubeUtil, Move } from './CubeLib';\nimport { CubieT, MoveT } from './Defs';\nimport { arrayEqual } from './Math';\n\nimport { Pruner, PrunerT, fbdrPrunerConfig } from './Pruner';\n\n\ntype SolverConfig = {\n    is_solved: (cube : CubieT) => boolean,\n    moveset: MoveT[],\n    pruners: PrunerT[],\n}\n\nlet defaultSolver = {\n    is_solved: CubeUtil.is_cube_solved,\n    moveset: Move.all,\n    pruner: [],\n}\n\ntype Accumulator = {\n    solutions: MoveT[][],\n    capacity: number\n}\n\nexport type SolverT = {\n    solve: (cube : CubieT, l : number, r : number, c : number) => MoveT[][],\n    is_solved: (cube : CubieT) => boolean,\n    getPruner: () => PrunerT[]\n}\nfunction Solver(config: SolverConfig) : SolverT{\n    const MAX_STATE_COUNT = 1000000\n    let { moveset, is_solved, pruners } = config\n    let state_count = 0, prune_count = 0;\n    let accum : Accumulator\n    let max_depth : number\n    let min_depth : number\n\n    enum SState {\n        CONTINUE,\n        STOP\n    };\n\n    function solve_depth(cube: CubieT, min_depth_: number, max_depth_: number, accum_: Accumulator) {\n        accum = accum_\n        max_depth = max_depth_\n        min_depth = min_depth_\n        state_count = 0\n        prune_count = 0\n        search(cube, 0, [])\n        return accum\n    }\n\n    function expand(cube: CubieT, depth: number, solution: MoveT[]) : SState{\n        let last_move_face = solution.length > 0 ? solution[solution.length - 1].name[0] : \"\"\n        for (let move of moveset) {\n            if (move.name[0] === last_move_face) continue;\n            let new_cube = CubieCube.apply(cube, move)\n            let redundant = pruners[0].equal(new_cube, cube)\n            if (!redundant) {\n                solution.push(move);\n                let st : SState = search(new_cube, depth + 1, solution);\n                solution.pop();\n                if (st === SState.STOP) {\n                    return SState.STOP\n                }\n            }\n        }\n        return SState.CONTINUE\n    }\n\n    function try_push(solution: MoveT[], depth: number) {\n        if (depth < min_depth) return SState.CONTINUE\n        if (accum.solutions.length < accum.capacity) {\n            let flag = true\n            for (let sol of accum.solutions) {\n                if (arrayEqual(sol, solution)) {\n                    flag = false;\n                    break;\n                }\n            }\n            if (flag) {\n                accum.solutions.push([...solution])\n            }\n        }\n\n        if (accum.solutions.length === accum.capacity) {\n            return SState.STOP\n        } else {\n            return SState.CONTINUE\n        }\n    }\n\n    function search(cube: CubieT, depth: number, solution: MoveT[]) : SState {\n        state_count++;\n        if (state_count > MAX_STATE_COUNT) {\n            return SState.STOP\n        }\n        if (is_solved(cube)) {\n            return try_push(solution, depth)\n        } else {\n            if (depth >= max_depth) return SState.CONTINUE;\n            let d = pruners[0].query(cube)\n            if (d + depth > max_depth) {\n                prune_count++;\n                return SState.CONTINUE\n            } else {\n                return expand(cube, depth, solution)\n            }\n        }\n    }\n\n    function solve(cube: CubieT, depth_l: number, depth_r: number, capacity: number) {\n        let accum : Accumulator = {\n            solutions: [],\n            capacity\n        }\n        for (let i = depth_l; i <= depth_r; i++) {\n            accum = solve_depth(cube, depth_l, i, accum)\n            if (accum.solutions.length === accum.capacity) {\n                break;\n            }\n        }\n        console.log(`Number of states = ${state_count}, pruned = ${prune_count}`);\n        return accum.solutions\n    }\n\n    function getPruner() {\n        return pruners\n    }\n    return { solve, is_solved, getPruner }\n};\n\nlet FbdrSolver = function() {\n    let prunerConfig = fbdrPrunerConfig\n    let pruner = Pruner(prunerConfig)\n    pruner.init()\n    //let solvedEncodings = prunerConfig.solved_states.map(s => prunerConfig.encode(s))\n    function is_solved(cube: CubieT) {\n        return pruner.query(cube) === 0;\n    }\n\n    let config = {\n        is_solved,\n        moveset: prunerConfig.moveset,\n        pruners: [pruner],\n    }\n\n    let solver = Solver(config)\n    return solver\n}\n\nexport { FbdrSolver }","import { FbdrSolver, SolverT } from './Solver';\n\nlet CachedSolver = function() {\n    let cache : Map<string, SolverT> = new Map()\n    function get(s: string) {\n        if (!cache.has(s)) {\n            switch (s) {\n                case \"fbdr\": cache.set(s, FbdrSolver())\n            }\n        }\n        return cache.get(s) as SolverT\n    }\n    return {get}\n}()\n\nexport {CachedSolver}","\nimport { AppState, StateT, Action, Mode } from \"./Types\"\nimport { alg_generator, AlgDesc } from \"./lib/Algs\"\nimport { MoveT } from \"./lib/Defs\";\nimport { CubieCube, Move, CubeUtil } from './lib/CubeLib';\nimport { setConfig, getConfig} from './components/Config';\nimport { FbdrSolver } from './lib/Solver';\nimport { CachedSolver } from \"./lib/CachedSolver\";\n\nexport const getInitialState = (mode?: Mode) : AppState => {\n    mode = mode || \"fbdr\"\n    let initialStateName : StateT = function() {\n        switch (mode){\n            case \"cmll\": return \"solved\"\n            case \"fbdr\": return \"revealed\"\n        }\n    }()\n    return {\n        name: initialStateName,\n        mode,\n        cube: {\n            state: CubieCube.id,\n            ori: \"WG\",\n            history: [],\n        },\n        case: {\n            state: CubieCube.id,\n            desc: []\n        },\n        config: getConfig()\n    }\n}\n\nexport function reducer(state: AppState, action: Action): AppState {\n    // todo: cache values based on this\n    console.log(\"prev state\", state)\n    if (action.type === \"key\") {\n        let newState = reduceKey(state, action.content)\n        return newState\n    } else if (action.type === \"config\") {\n        setConfig(action.content)\n        return {\n            ...state,\n            config: getConfig()\n        }\n    } else if (action.type === \"mode\") {\n        let mode = action.content\n        state = getInitialState(mode)\n        return state\n    } else{\n        return state\n    }\n}\n\n// State Manager\n// Handles actions based on state.\n// \"Passively\" updates localstorage in reduce.\nabstract class StateM {\n    state: AppState;\n    constructor(state: AppState) {\n        this.state = state\n    }\n    abstract move(s: string): AppState;\n\n    static create(state: AppState) {\n        if (state.mode === \"fbdr\") {\n            return new FbdrStateM(state)\n        }\n        else if (state.name === \"solving\") {\n            return new SolvingStateM(state)\n        } else {\n            return new SolvedStateM(state)\n        }\n    }\n}\n\n\nabstract class CmllStateM extends StateM {\n    control(s: string): AppState {\n        let state = this.state\n        let { config, mode } = state\n        let { cmllSelector, triggerSelector, cmllAufSelector, orientationSelector } = config\n        let generator = alg_generator(cmllSelector)\n        let trig_generator = alg_generator(triggerSelector)\n        let u_auf_generator = alg_generator(cmllAufSelector)\n        let ori_generator = alg_generator(orientationSelector)\n\n        if (s === \"#enter\") {\n            // SCRAMBLE\n            // enter cleared solving state based on selection\n            let trigger_alg: AlgDesc = trig_generator()\n            let alg: AlgDesc = generator();\n            let u_auf_alg: AlgDesc = u_auf_generator()\n            let alg_str = trigger_alg.alg + \" \" + u_auf_alg.alg + \" \" + alg.alg\n            let moves: MoveT[] = Move.inv(Move.parse(alg_str));\n\n            //console.log(\"moves\", Move.to_string(moves))\n            let cube = CubeUtil.get_random_lse()\n            cube = CubieCube.apply(cube, moves)\n\n            // ori based on ...?\n            let ori: string = ori_generator().id\n            //console.log(\"current ori selector's ori \", ori)\n\n            return ({...state,\n                name: \"solving\",\n                cube: {\n                    state: cube,\n                    ori,\n                    history: [],\n                },\n                case: {\n                    state: cube,\n                    desc: [trigger_alg, alg]\n                },\n            })\n        } else if (s === \"#space\") {\n            // REDO\n            return ({...state,\n                name: \"solving\",\n                cube: {\n                    ...state.cube,\n                    state: state.case.state,\n                    history: []\n                },\n                case: {\n                    ...state.case,\n                }\n            })\n        } else {\n            throw new Error(\"Unrecognized control code\")\n        }\n    }\n}\n\nclass FbdrStateM extends StateM {\n    updateScramble() : AppState {\n        let state = this.state\n        let cube = CubeUtil.get_random_fs()\n        let solver = CachedSolver.get(\"fbdr\")\n        let scramble = solver.solve(cube, 8, 10, 1)[0]\n        let setup = Move.to_string(Move.inv(scramble))\n        let solution = solver.solve(cube, 0, 10, 5)\n        let alg = Move.to_string(solution[0])\n        let alt_algs = solution.slice(1).map((s: MoveT[]) => Move.to_string(s))\n\n        let algdesc: AlgDesc = {\n            id: `fpdr-random`,\n            alg,\n            alt_algs,\n            setup,\n            kind: \"fbdr\"\n        }\n        // console.log(\"algdesc\", algdesc)\n        return {\n            ...state,\n            name: \"hiding\",\n            cube: {\n                ...state.cube,\n                state: cube,\n            },\n            case: {\n                ...state.case,\n                desc: [algdesc]\n            }\n        }\n    }\n    control(s: string): AppState {\n        let state = this.state\n        if (s === \"#space\") {\n            if (state.name === \"revealed\" || state.name === \"revealed_all\") {\n                return this.updateScramble()\n            } else {\n                return {...state,\n                    name: \"revealed\"\n                }\n            }\n        }\n        else if (s === \"#enter\") {\n            if (state.name === \"revealed_all\") {\n                return this.updateScramble()\n            } else if (state.name === \"revealed\" || state.name === \"hiding\" ) {\n                let newState = { ...state }\n                newState.name = \"revealed_all\"\n                return newState\n            } else {\n                return state\n            }\n        }\n        else {\n            return state\n        }\n    }\n    move(movestr: string): AppState {\n        let state = this.state\n        let move = Move.parse(movestr)[0]\n        let cube = CubieCube.apply(state.cube.state, move)\n        return {\n            ...state,\n            cube: {\n                ...state.cube,\n                state: cube\n            }\n        }\n    }\n}\n\n\n\nclass SolvingStateM extends CmllStateM {\n    move(move: string): AppState {\n        let state = this.state\n        let moves = Move.parse(move)\n        if (moves.length > 0) {\n            let move = moves[0]\n            let cube = CubieCube.apply(state.cube.state, move)\n            let cmll_solved = CubeUtil.is_cmll_solved(cube)\n            let newState: StateT = cmll_solved ? \"solved\" : \"solving\";\n            return({...state,\n                cube: {\n                    ...state.cube,\n                    state: CubieCube.apply(state.cube.state, move),\n                    history: [...state.cube.history, move],\n                },\n                name: newState\n            })\n        } else {\n            // Nothing to apply\n            return state\n        }\n    }\n}\n\nclass SolvedStateM extends CmllStateM {\n    move(move: string): AppState {\n        return this.state\n    }\n}\n\nfunction reduceKey(state: AppState, code: string): AppState {\n    if (code === \"\") return state;\n\n    const stateM = StateM.create(state)\n    // case match on kind of operation\n    if (code[0] === \"#\") {\n        return stateM.control(code)\n    } else {\n        return stateM.move(code)\n    }\n}","import React from 'react'\nimport { defaultKeyMapping } from \"../lib/Defs\";\nimport AppView from \"../components/AppView\"\nimport { reducer, getInitialState } from '../Reducer'\n\nwindow.addEventListener('keydown', function(e) {\n  if(e.keyCode === 32 && e.target === document.body) {\n    e.preventDefault();\n  }\n});\n\nfunction App(props: {}) {\n  const [state, dispatch] = React.useReducer( reducer, getInitialState() )\n\n  // Add event listeners\n  React.useEffect(() => {\n    function downHandler({ key }: { key : string}) {\n      key = key.toUpperCase()\n      if (defaultKeyMapping.hasOwnProperty(key)) {\n        dispatch({\n          type: \"key\", content: defaultKeyMapping[key] }\n        );\n      }\n    }\n    window.addEventListener('keydown', downHandler);\n    return () => {\n      window.removeEventListener('keydown', downHandler);\n    };\n  });\n\n  return (\n    <AppView state={state} dispatch={dispatch} />\n  )\n}\nexport default App","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import { red } from '@material-ui/core/colors';\nimport { createMuiTheme } from '@material-ui/core/styles';\n\n// A custom theme for this app\nconst theme = createMuiTheme({\n  palette: {\n    primary: {\n      main: '#556cd6',\n    },\n    secondary: {\n      main: '#19857b',\n    },\n    error: {\n      main: red.A400,\n    },\n    background: {\n      default: '#fff',\n    },\n  },\n});\n\nexport default theme;","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './app/App';\nimport * as serviceWorker from './serviceWorker';\nimport CssBaseline from '@material-ui/core/CssBaseline';\nimport { ThemeProvider } from '@material-ui/core/styles';\nimport theme from './theme';\n\nReactDOM.render(\n    <ThemeProvider theme={theme}>\n      {/* CssBaseline kickstart an elegant, consistent, and simple baseline to build upon. */}\n      <CssBaseline />\n      <App />\n    </ThemeProvider>,\n    document.getElementById('root'),\n  );\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}